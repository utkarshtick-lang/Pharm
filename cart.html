<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Your shopping cart - Review and checkout your items at Shreya Pharmacy.">
    <title>Cart | Shreya Pharmacy</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

    <link rel="stylesheet" href="style.css">
    <style>
        .page-header {
            padding: 8rem 2rem 3rem;
            text-align: center;
            background: var(--gradient-dark);
        }

        .page-title {
            font-family: var(--font-display);
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 700;
        }

        .cart-page {
            padding: 3rem 2rem;
            background: var(--bg-dark);
            min-height: 50vh;
        }

        .cart-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 2rem;
            align-items: start;
        }

        .cart-items {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            overflow: hidden;
        }

        .cart-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-header h2 {
            font-size: 1.3rem;
        }

        .clear-cart {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 0.9rem;
            transition: color 0.3s;
        }

        .clear-cart:hover {
            color: #f87171;
        }

        .cart-list {
            list-style: none;
        }

        .cart-item {
            display: grid;
            grid-template-columns: 80px 1fr auto auto;
            gap: 1.5rem;
            padding: 1.5rem;
            border-bottom: 1px solid var(--glass-border);
            align-items: center;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .item-image {
            width: 80px;
            height: 80px;
            background: var(--bg-card);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
        }

        .item-details h3 {
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
        }

        .item-details .item-category {
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }

        .item-details .item-price {
            color: var(--primary);
            font-weight: 600;
        }

        .item-qty {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .qty-btn {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            border: 1px solid var(--glass-border);
            background: var(--glass-bg);
            color: var(--text);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .qty-btn:hover {
            background: var(--primary);
            color: #fff;
            border-color: transparent;
        }

        .qty-value {
            width: 40px;
            text-align: center;
            font-weight: 600;
        }

        .item-remove {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0.5rem;
            transition: color 0.3s;
        }

        .item-remove:hover {
            color: #f87171;
        }

        .cart-empty {
            padding: 4rem 2rem;
            text-align: center;
        }

        .cart-empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .cart-empty h3 {
            margin-bottom: 0.5rem;
        }

        .cart-empty p {
            color: var(--text-muted);
            margin-bottom: 1.5rem;
        }

        .continue-shopping {
            display: inline-block;
            padding: 0.8rem 1.5rem;
            background: var(--gradient-primary);
            color: #fff;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            transition: transform 0.3s;
        }

        .continue-shopping:hover {
            transform: translateY(-2px);
        }

        .cart-summary {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 1.5rem;
            position: sticky;
            top: 100px;
        }

        .summary-title {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--glass-border);
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
        }

        .summary-row.total {
            font-size: 1.2rem;
            font-weight: 700;
            border-top: 1px solid var(--glass-border);
            padding-top: 1rem;
            margin-top: 1rem;
        }

        .summary-row .label {
            color: var(--text-muted);
        }

        .promo-form {
            display: flex;
            gap: 0.5rem;
            margin: 1.5rem 0;
        }

        .promo-input {
            flex: 1;
            padding: 0.8rem 1rem;
            background: var(--bg-darker);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            color: var(--text);
        }

        .promo-btn {
            padding: 0.8rem 1.2rem;
            background: var(--primary);
            border: none;
            border-radius: 10px;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .promo-btn:hover {
            transform: translateY(-2px);
        }

        .checkout-btn {
            width: 100%;
            padding: 1rem;
            background: var(--gradient-primary);
            border: none;
            border-radius: 50px;
            color: #fff;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .checkout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(196, 167, 125, 0.3);
        }

        .checkout-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .secure-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1rem;
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        @media (max-width: 900px) {
            .cart-container {
                grid-template-columns: 1fr;
            }

            .cart-item {
                grid-template-columns: 60px 1fr;
                gap: 1rem;
            }

            .item-qty,
            .item-remove {
                grid-column: 2;
            }
        }
    </style>
</head>

<body>
    <canvas id="cursor-trail"></canvas>
    <canvas id="particle-bg"></canvas>

    <!-- Navigation -->
    <nav id="navbar" class="navbar scrolled">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <span class="logo-icon">ðŸ’Š</span>
                <span class="logo-text">SHREYA</span>
            </a>
            <ul class="nav-links">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li><a href="wholesale.html" class="nav-link">Wholesale</a></li>
                <li><a href="products.html" class="nav-link">Products</a></li>
                <li><a href="about.html" class="nav-link">About</a></li>
            </ul>
            <div class="nav-actions">
                <a href="cart.html" class="nav-btn cart-btn active" aria-label="Cart">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="9" cy="21" r="1" />
                        <circle cx="20" cy="21" r="1" />
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6" />
                    </svg>
                    <span class="cart-count">0</span>
                </a>
                <a href="auth.html" class="nav-btn auth-btn magnetic-btn">
                    <span>Sign In</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <header class="page-header">
        <h1 class="page-title">Your <span class="gradient-text">Cart</span></h1>
    </header>

    <!-- Cart Content -->
    <section class="cart-page">
        <div class="cart-container">
            <!-- Cart Items -->
            <div class="cart-items">
                <div class="cart-header">
                    <h2>Shopping Cart (<span id="item-count">0</span> items)</h2>
                    <button class="clear-cart" onclick="clearCart()">Clear All</button>
                </div>

                <ul class="cart-list" id="cart-list">
                    <!-- Items loaded by JS -->
                </ul>

                <div class="cart-empty" id="cart-empty" style="display: none;">
                    <div class="cart-empty-icon">ðŸ›’</div>
                    <h3>Your cart is empty</h3>
                    <p>Looks like you haven't added any items yet.</p>
                    <a href="products.html" class="continue-shopping">Continue Shopping</a>
                </div>
            </div>

            <!-- Cart Summary -->
            <div class="cart-summary">
                <h2 class="summary-title">Order Summary</h2>

                <div class="summary-row">
                    <span class="label">Subtotal</span>
                    <span id="subtotal">â‚¹0.00</span>
                </div>
                <div class="summary-row">
                    <span class="label">Shipping</span>
                    <span id="shipping">Free</span>
                </div>
                <div class="summary-row">
                    <span class="label">Tax (8%)</span>
                    <span id="tax">â‚¹0.00</span>
                </div>
                <div class="summary-row total">
                    <span>Total</span>
                    <span id="total">â‚¹0.00</span>
                </div>

                <form class="promo-form" onsubmit="applyPromo(event)">
                    <input type="text" class="promo-input" placeholder="Promo code">
                    <button type="submit" class="promo-btn">Apply</button>
                </form>

                <button class="checkout-btn" id="checkout-btn" onclick="checkout()">
                    Proceed to Checkout
                </button>

                <div class="secure-badge">
                    <span>ðŸ”’</span>
                    <span>Secure checkout powered by Stripe</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-bottom">
                <p>&copy; 2045 Shreya Pharmacy. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <div id="toast-container" class="toast-container"></div>

    <script src="js/data.js"></script>
    <script src="js/effects.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/auth.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof initEffects === 'function') initEffects();
            cart.load();
            renderCartPage();
        });

        function renderCartPage() {
            const list = document.getElementById('cart-list');
            const empty = document.getElementById('cart-empty');
            const itemCount = document.getElementById('item-count');
            const subtotalEl = document.getElementById('subtotal');
            const taxEl = document.getElementById('tax');
            const totalEl = document.getElementById('total');
            const checkoutBtn = document.getElementById('checkout-btn');

            if (cart.items.length === 0) {
                list.style.display = 'none';
                empty.style.display = 'block';
                checkoutBtn.disabled = true;
            } else {
                list.style.display = 'block';
                empty.style.display = 'none';
                checkoutBtn.disabled = false;

                list.innerHTML = cart.items.map(item => `
          <li class="cart-item">
            <div class="item-image">${item.icon}</div>
            <div class="item-details">
              <h3>${item.name}</h3>
              <p class="item-category">${item.category}</p>
              <p class="item-price">$${item.price.toFixed(2)}</p>
            </div>
            <div class="item-qty">
              <button class="qty-btn" onclick="updateQty(${item.id}, -1)">âˆ’</button>
              <span class="qty-value">${item.quantity}</span>
              <button class="qty-btn" onclick="updateQty(${item.id}, 1)">+</button>
            </div>
            <button class="item-remove" onclick="removeItem(${item.id})">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
              </svg>
            </button>
          </li>
        `).join('');
            }

            const subtotal = cart.getTotal();
            const tax = subtotal * 0.08;
            const total = subtotal + tax;

            itemCount.textContent = cart.getCount();
            subtotalEl.textContent = `$${subtotal.toFixed(2)}`;
            taxEl.textContent = `$${tax.toFixed(2)}`;
            totalEl.textContent = `$${total.toFixed(2)}`;
        }

        function updateQty(id, delta) {
            const item = cart.items.find(i => i.id === id);
            if (item) {
                const newQty = item.quantity + delta;
                if (newQty > 0) {
                    cart.updateQuantity(id, newQty);
                } else {
                    cart.remove(id);
                }
                renderCartPage();
            }
        }

        function removeItem(id) {
            cart.remove(id);
            renderCartPage();
            showToast('Item removed from cart', 'info');
        }

        function clearCart() {
            cart.items = [];
            cart.save();
            cart.updateUI();
            renderCartPage();
            showToast('Cart cleared', 'info');
        }

        function applyPromo(e) {
            e.preventDefault();
            showToast('Promo code applied! (Demo)', 'success');
        }

        function checkout() {
            if (typeof auth !== 'undefined' && !auth.isAuthenticated()) {
                showToast('Please sign in to checkout', 'info');
                setTimeout(() => {
                    window.location.href = 'auth.html';
                }, 1500);
                return;
            }

            showToast('Redirecting to secure checkout...', 'success');
            // In a real app, this would redirect to Stripe/payment processor
        }
    </script>
    <script src="js/enhancements.js"></script>
</body>

</html>